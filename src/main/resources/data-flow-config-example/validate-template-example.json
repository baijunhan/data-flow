{
    "_id" : "sync_config",
    "template" : {
        "type": "object",
        "fields": {
            "_id": {
                "description": "id为库名+表名, 例如: [monix]-[repay_plan]",
                "type": "string",
                "required": true
            },
            "converter": {
                "description": "转换过程的配置, 可配置多个, 即一张原始表的数据变化时可同步多个目标表",
                "type": "list",
                "required": true,
                "item": {
                    "type": "object",
                    "fields": {
                        "core_table": {
                            "description": "目标表名称",
                            "type": "string",
                            "required": true
                        },
                        "eval_context": {
                            "description": "转换时所依赖的环境, 存储变量",
                            "type": "list",
                            "item": {
                                "type": "object",
                                "fields_option": "custom_data|sql,type|db_name,t_name,where_case",
                                "fields": {
                                    "type": {
                                        "type": "string",
                                        "value_option": [
                                            "list",
                                            "object"
                                        ]
                                    },
                                    "on_op_types": {
                                        "type": "list",
                                        "item": {
                                            "type": "string"
                                        }
                                    },
                                    "name": {
                                        "required": true,
                                        "type": "string"
                                    },
                                    "custom_data": {
                                        "required": false,
                                        "type": "string"
                                    },
                                    "data_source": {
                                        "required": false,
                                        "type": "string"
                                    },
                                    "sql": {
                                        "required": false,
                                        "type": "string",
                                        "value_reg": "(SELECT(.+?)FROM.+)"
                                    },
                                    "db_name": {
                                        "required": false,
                                        "type": "string"
                                    },
                                    "t_name": {
                                        "required": false,
                                        "type": "string"
                                    },
                                    "where_case": {
                                        "required": false,
                                        "type": "string"
                                    }
                                }
                            }
                        },
                        "simple_class_convert": {
                            "type": "boolean",
                            "required": false
                        },
                        "simple_value_convert": {
                            "type": "object",
                            "required": false,
                            "reg_key": {
                                "\\w+": {
                                    "type": "string"
                                }
                            }
                        },
                        "custom_operation": {
                            "type": "list",
                            "item": {
                                "type": "string"
                            }
                        },
                        "filter": {
                            "type": "string",
                            "value_reg": "\\w+"
                        },
                        "enums": {
                            "type": "object"
                        },
                        "conditional": {
                            "type": "list",
                            "item": {
                                "type": "object",
                                "fields": {
                                    "condition": {
                                        "type": "string",
                                        "required": true
                                    },
                                    "expression": {
                                        "type": "list|string",
                                        "required": true,
                                        "item": {
                                            "type": "object|string",
                                            "fields_ref": "fields.converter.item.fields.conditional.item.fields",
                                            "value_reg": "."
                                        }
                                    }
                                }
                            }
                        },
                        "db_update": {
                            "type": "object",
                            "required": true,
                            "fields": {
                                "insert": {
                                    "type": "object",
                                    "fields": {
                                        "auto_id": {
                                            "required": true,
                                            "type": "boolean"
                                        }
                                    }
                                }
                            },
                            "reg_key": {
                                "(select)|(update)|(delete)": {
                                    "type": "object",
                                    "fields_option": "sql|qualified_field",
                                    "fields": {
                                        "qualified_field": {
                                            "type": "list",
                                            "item": {
                                                "type": "string",
                                                "value_option": [
                                                    "o1"
                                                ]
                                            }
                                        },
                                        "sql": {
                                            "type": "string",
                                            "value": "SELECT.*?FROM"
                                        }
                                    }
                                }
                            }
                        },
                        "pre_processor": {
                            "required": true,
                            "type": "string"
                        },
                        "post_processor": {
                            "type": "string"
                        }
                    }
                }
            }
        }
    }
}